<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Properties | Horizon Admin</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/admin.css">
    <link rel="stylesheet" href="css/navbar.css">
</head>
<body>
    <!-- SUCCESS POPUP -->
<div id="successModal" class="modal-overlay">
  <div class="modal-box">
    <h2 id="successTitle">Success</h2>
    <p id="successMessage">Action completed successfully.</p>

    <div class="modal-actions">
      <button id="successOkBtn" class="btn btn-primary">OK</button>
    </div>
  </div>
</div>

<!-- DELETE CONFIRMATION POPUP -->
<div id="deleteModal" class="modal-overlay" style="display:none;">
  <div class="modal-box">
    <h2>Delete Property</h2>
    <p>Are you sure you want to remove this property?</p>

    <div class="modal-actions">
      <button id="cancelDelete" class="btn btn-outline">Cancel</button>
      <button id="confirmDelete" class="btn btn-danger">Delete</button>
    </div>
  </div>
</div>

<!-- Navbar -->
<nav class="navbar">
    <a href="dashboard.html" class="logo">Horizon<span>Haven</span></a>
    <div class="nav-links" id="auth-area">
        <a href="login.html" id="List">List your property</a>
        <button class="login-btn" onclick="window.location.href='login.html'">
            Log in / Sign up
        </button>
    </div>
</nav>

<nav class="sidebar">
    <div class="nav">
        <a href="/admin.html" class="nav-link">Dashboard</a>
        <a href="/properties.html" class="nav-link active">Properties</a>
        <a href="/admin-bookings.html" class="nav-link">Bookings</a>
    </div>
</nav>

<main class="main">

<!-- LIST VIEW -->
<div id="listView">
    <header class="header">
        <div>
            <h1>Properties</h1>
            <p style="color:var(--text-muted); margin-top:4px;">
                Manage your hotel listings and room inventory.
            </p>
        </div>

        <div class="header-actions">
            <div class="search-wrapper">
                <input 
                    type="text" 
                    id="property-search" 
                    class="search-input" 
                    placeholder="Search hotels, locations..."
                >
            </div>

            <button onclick="switchToFormView()" class="btn btn-primary">
                Add Property
            </button>
        </div>
    </header>

    <div class="property-list" id="property-list">
        <div class="loading-skeleton"></div>
        <div class="loading-skeleton"></div>
    </div>
</div>

<!-- FORM VIEW -->
<div id="formView" style="display: none;">
    <header class="header">
        <h1 id="form-title">Add Property</h1>
        <button onclick="switchToListView()" class="btn btn-outline">Cancel</button>
    </header>

    <form id="propertyForm" class="form-container" onsubmit="handleAddProperty(event)">
        <input type="hidden" id="propId" name="id" value="0">

        <div class="form-group">
            <label>Property Name</label>
            <input type="text" name="name" id="name" class="form-control" required>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>Location</label>
                <input type="text" name="location" id="location" class="form-control" required>
            </div>

            <div class="form-group">
                <label>Price Range</label>
                <input type="text" name="priceRange" id="priceRange" class="form-control">
            </div>
        </div>

        <div class="form-group">
            <label>Address</label>
            <textarea name="address" id="description" class="form-control"></textarea>
        </div>

        <div class="form-group">
            <label>Description</label>
            <textarea name="description" id="description" class="form-control"></textarea>
        </div>

        <div class="file-upload casual-upload" style="position: relative;">
            <div class="icon">ðŸ“·</div>
            <p>Click to upload photos</p>
            <span>Add at least 1 photo</span>

            <!-- REAL input that handles clicking, but invisible -->
            <input type="file" name="photos" multiple accept="image/*" class="hidden-file"
                style="position:absolute; inset:0; opacity:0; cursor:pointer;">
        </div>

        <div class="form-group">
            <label>Property Type</label>
            <select name="type" class="form-control">
                <option>Apartment</option>
                <option>Entire House</option>
                <option>Guest Suite</option>
                <option>Vacation Cabin</option>
            </select>
        </div>

        <div style="margin-top: 32px; text-align: right;">
            <button type="submit" class="btn btn-primary">Save Property</button>
        </div>
    </form>
</div>

<div id="formViewEdit" style="display: none;">
    <header class="header">
        <h1 id="form-title-edit">Edit Property</h1>
        <button onclick="switchToListViewEdit()" class="btn btn-outline">Cancel</button>
    </header>

    <form id="propertyFormEdit" class="form-container" onsubmit="handleEditProperty(event)">
        <input type="hidden" id="propIdEdit" name="id" value="0">

        <div class="form-group">
            <label>Property Name</label>
            <input type="text" name="name" id="nameEdit" class="form-control" required>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label>Location</label>
                <input type="text" name="location" id="locationEdit" class="form-control" required>
            </div>

            <div class="form-group">
                <label>Price Range</label>
                <input type="text" name="priceRange" id="priceRangeEdit" class="form-control">
            </div>
        </div>

        <div class="form-group">
            <label>Address</label>
            <textarea name="address" id="addressEdit" class="form-control"></textarea>
        </div>

        <div class="form-group">
            <label>Description</label>
            <textarea name="description" id="descriptionEdit" class="form-control"></textarea>
        </div>

        <div class="file-upload casual-upload" style="position: relative;">
            <div class="icon">ðŸ“·</div>
            <p>Click to upload photos</p>
            <span>Add at least 1 photo</span>

            <input type="file" name="photos" multiple accept="image/*" class="hidden-file"
                style="position:absolute; inset:0; opacity:0; cursor:pointer;">
        </div>

        <div class="form-group">
            <label>Property Type</label>
            <select name="type" id="typeEdit" class="form-control">
                <option>Apartment</option>
                <option>Entire House</option>
                <option>Guest Suite</option>
                <option>Vacation Cabin</option>
            </select>
        </div>

        <div style="margin-top: 32px; text-align: right;">
            <button type="submit" class="btn btn-primary">Update Property</button>
        </div>
    </form>
</div>


</main>

<script type="module" src="js/properties.js"></script>
<script type="module" src="js/navbar.js"></script>

<script>
function switchToListView() {
    document.getElementById('listView').style.display = 'block';
    document.getElementById('formView').style.display = 'none';
    document.getElementById('formViewEdit').style.display = 'none';

    document.getElementById('propertyForm').reset();
    document.getElementById('propId').value = '0';
}

function switchToListViewEdit() {
    document.getElementById('listView').style.display = 'block';
    document.getElementById('formViewEdit').style.display = 'none';
    document.getElementById('formView').style.display = 'none';

    document.getElementById('propertyFormEdit').reset();
    document.getElementById('propIdEdit').value = '0';
}

function switchToFormView() {
    document.getElementById('listView').style.display = 'none';
    document.getElementById('formView').style.display = 'block';
    document.getElementById('formViewEdit').style.display = 'none';

    isEditing = false;        // âœ… FORCE ADD MODE
    currentEditId = null;
}


function switchToEditView(propertyId) {
    document.getElementById('listView').style.display = 'none';
    document.getElementById('formView').style.display = 'none';
    document.getElementById('formViewEdit').style.display = 'block';

    isEditing = true;              // âœ… FORCE EDIT MODE
    currentEditId = propertyId;   // âœ… STORE ID SAFELY

    loadPropertyForEdit(propertyId);

}
    window.switchToEditView = switchToEditView;

    window.switchToFormView = switchToFormView;

</script>

</body>
</html>
